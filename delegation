$Searcher = [adsisearcher]""
# The generic bitwise filter for 524288
$Searcher.Filter = "(&(objectCategory=computer)(userAccountControl:1.2.840.113556.1.4.803:=524288))"

$Searcher.FindAll() | ForEach-Object {
    $Obj = $_.Properties
    [PSCustomObject]@{
        Hostname = $Obj.dcnshostname[0]
        OS       = $Obj.operatingsystem[0]
    }
}
